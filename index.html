<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGSIST | Live Ag Dashboard</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23e6b042%22 rx=%2212%22></rect><text x=%2250%22 y=%2244%22 font-family=%22Arial-Black, sans-serif%22 font-weight=%22900%22 font-size=%2248%22 text-anchor=%22middle%22 fill=%22black%22>AG</text><text x=%2250%22 y=%2286%22 font-family=%22Arial-Black, sans-serif%22 font-weight=%22900%22 font-size=%2232%22 text-anchor=%22middle%22 fill=%22black%22>SIST</text></svg>">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root{--bg:#050508;--panel:#0a0a10;--card:#0f0f16;--hover:#16161f;--border:#1f1f2a;--accent:#e6b042;--accent-dim:#b3862b;--green:#2ad568;--red:#f44336;--text:#e2e2ed;--dim:#8a8aa5;--bright:#ffffff}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Space Grotesk',system-ui,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;font-size:15px;line-height:1.4;display:flex;flex-direction:column}
        
        /* SCROLLBARS */
        ::-webkit-scrollbar{width:6px;height:6px}
        ::-webkit-scrollbar-track{background:var(--bg)}
        ::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
        ::-webkit-scrollbar-thumb:hover{background:var(--dim)}

        /* TICKER */
        .ticker-wrap{background:var(--panel);border-bottom:1px solid var(--border);overflow:hidden;white-space:nowrap;padding:8px 0;position:relative;z-index:20}
        .ticker{display:inline-flex;animation:scroll 120s linear infinite;}
        .ticker:hover{animation-play-state:paused}
        .ticker-item{font-family:'JetBrains Mono',monospace;font-size:.85rem;color:var(--bright);padding:0 20px;font-weight:500;display:inline-flex;align-items:center;border-right:1px solid #1a1a24;text-decoration:none}
        .ticker-item .label{color:var(--dim);font-size:.75rem;margin-right:8px}
        .ticker-item .up{color:var(--green);margin-left:6px}.ticker-item .down{color:var(--red);margin-left:6px}
        a.ticker-item:hover {background:var(--hover)}
        .ticker-news { color: var(--accent); font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        .ticker-news .source { background: var(--accent-dim); color: #000; padding: 1px 5px; border-radius: 2px; font-size: 0.65rem; margin-right: 8px; font-weight:700}
        @keyframes scroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
        
        /* HEADER */
        header{background:rgba(10,10,16,0.95);backdrop-filter:blur(10px);border-bottom:1px solid var(--border);padding:12px 24px;position:sticky;top:0;z-index:100}
        .header-inner{max-width:1800px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;gap:16px}
        
        /* LOGO */
        .logo{text-decoration:none;display:flex;align-items:center;gap:12px}
        .logo-icon{
            width:42px; height:42px;
            background:var(--accent);
            display:flex; flex-direction:column; justify-content:center; align-items:center;
            border-radius:6px;
            color:#000;
            line-height:0.8;
            font-family:'Space Grotesk',sans-serif;
            font-weight:900;
            padding-top:2px;
        }
        .logo-icon .top-text{font-size:1.2rem; letter-spacing:-1px}
        .logo-icon .bot-text{font-size:0.75rem; letter-spacing:0px}
        .logo-text{font-family:'Space Grotesk',sans-serif;font-size:1.6rem;font-weight:800;color:var(--bright);letter-spacing:-0.02em; text-transform:uppercase}
        
        .nav{display:flex;gap:4px;background:var(--card);padding:4px;border-radius:6px;border:1px solid var(--border)}
        .nav a{font-family:'JetBrains Mono',monospace;font-size:.75rem;color:var(--dim);text-decoration:none;padding:8px 16px;border-radius:4px;transition:.2s;font-weight:600}
        .nav a:hover{color:var(--bright)}
        .nav a.active{background:var(--accent);color:#000}
        
        .live-badge{display:flex;align-items:center;gap:8px;font-family:'JetBrains Mono',monospace;font-size:.75rem;color:var(--dim);background:var(--card);padding:6px 12px;border-radius:4px;border:1px solid var(--border)}
        .live-dot{width:6px;height:6px;background:var(--green);border-radius:50%;animation:blink 2s infinite;box-shadow:0 0 8px var(--green)}
        @keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}
        
        /* MAIN */
        main{max-width:1800px;margin:0 auto;padding:20px; flex:1; width:100%}
        .tab{display:none}.tab.active{display:block}
        .grid-main{display:grid;grid-template-columns:1fr 350px;gap:20px;align-items:start}
        
        /* PANELS */
        .panel{background:var(--panel);border:1px solid var(--border);border-radius:6px;overflow:hidden;margin-bottom:20px}
        .panel-head{background:var(--card);padding:12px 16px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
        .panel-head h2{font-family:'JetBrains Mono',monospace;font-size:.8rem;color:var(--accent);letter-spacing:1px;font-weight:700;text-transform:uppercase}
        .panel-body{padding:16px}
        
        .section-label{font-family:'JetBrains Mono',monospace;font-size:.75rem;color:var(--dim);letter-spacing:1px;margin:20px 0 10px;font-weight:700;display:flex;align-items:center;gap:8px}
        .section-label::after{content:'';height:1px;background:var(--border);flex:1}
        
        /* MARKET CARDS */
        .market-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:10px}
        .market-card{background:var(--card);border:1px solid var(--border);padding:14px;border-radius:4px;transition:all .2s;position:relative;overflow:hidden}
        .market-card:hover{border-color:var(--accent-dim);transform:translateY(-2px);background:#13131c}
        .market-card .head{display:flex;justify-content:space-between;align-items:start;margin-bottom:6px}
        .market-card .name{font-size:.95rem;color:var(--bright);font-weight:600;line-height:1.2}
        .market-card .symbol{font-family:'JetBrains Mono',monospace;font-size:.65rem;color:var(--dim)}
        .market-card .price{font-family:'JetBrains Mono',monospace;font-size:1.4rem;font-weight:700;color:var(--bright);margin-bottom:4px}
        .market-card .meta{display:flex;justify-content:space-between;align-items:center;font-size:.75rem;font-family:'JetBrains Mono',monospace}
        
        /* 52 WK RANGE */
        .range-container { margin-top: 12px; padding-top: 10px; border-top: 1px solid var(--hover); }
        .range-bar { height: 4px; background: var(--border); border-radius: 2px; position: relative; width: 100%; margin-bottom: 6px; }
        .range-cursor { width: 8px; height: 8px; background: var(--accent); border-radius: 50%; position: absolute; top: -2px; transform: translateX(-50%); box-shadow: 0 0 0 2px var(--card); }
        .range-labels { display: flex; justify-content: space-between; font-family: 'JetBrains Mono', monospace; font-size: 0.65rem; color: var(--dim); }

        /* SIDEBAR */
        .sidebar-stack{position:sticky;top:80px;display:flex;flex-direction:column;gap:20px;max-height:calc(100vh - 100px);overflow-y:auto;padding-right:4px}
        
        /* FEEDS */
        .feed-header{padding:12px 16px;background:var(--card);border-bottom:1px solid var(--border);font-family:'JetBrains Mono',monospace;font-size:.75rem;color:var(--bright);font-weight:700;display:flex;align-items:center;justify-content:space-between}
        .feed-scroll{max-height:350px;overflow-y:auto;background:#000}
        
        .news-item{display:block;padding:14px 16px;border-bottom:1px solid var(--border);text-decoration:none;transition:.2s}
        .news-item:hover{background:var(--hover)}
        .news-item .tag{display:inline-block;padding:2px 6px;border-radius:2px;font-size:.6rem;font-weight:700;margin-bottom:6px;font-family:'JetBrains Mono',monospace}
        .news-item .tag.usda{background:rgba(42,79,135,0.3);color:#8ca6d4;border:1px solid rgba(42,79,135,0.5)}
        .news-item .tag.agweb{background:rgba(230,176,66,0.15);color:#e6b042;border:1px solid rgba(230,176,66,0.3)}
        .news-item h4{font-size:.9rem;color:var(--text);font-weight:500;line-height:1.4}

        /* TOOLS */
        .tool-grid{display:grid;grid-template-columns:1fr 1fr;gap:1px;background:var(--border)}
        .tool-btn{background:var(--card);padding:20px;text-align:center;text-decoration:none;transition:.2s;display:flex;flex-direction:column;align-items:center;gap:10px;cursor:pointer}
        .tool-btn:hover{background:var(--hover)}
        .tool-btn span{font-size:1.4rem}
        .tool-btn h5{font-size:.8rem;color:var(--text);font-weight:600}

        /* LOCAL MARKETS */
        .elevator-item{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid var(--border);font-size:.95rem}
        .elevator-item:last-child{border:none}
        .elevator-name{color:var(--text);font-weight:500}
        .elevator-dist{font-family:'JetBrains Mono',monospace;color:var(--dim);font-size:.85rem}

        /* WEATHER */
        .weather-grid{display:grid;grid-template-columns:1.8fr 1fr;gap:0; border:1px solid var(--border); border-radius:4px; overflow:hidden}
        .radar-box{height:320px;background:var(--card);border-right:1px solid var(--border);position:relative}
        .radar-box iframe{width:100%;height:100%;border:none}
        .forecast-list{padding:16px; display:flex; flex-direction:column; gap:8px; overflow-y:auto; height:320px; background:var(--card)}
        .forecast-mini{background:var(--panel);padding:10px;border-radius:4px;border:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
        .forecast-mini .day{font-family:'JetBrains Mono',monospace;font-size:.75rem;color:var(--accent);font-weight:600}
        .forecast-mini .temp{font-weight:700;color:var(--bright);font-size:.9rem}
        .locate-btn {position:absolute; bottom:10px; right:10px; background:var(--card); border:1px solid var(--border); color:var(--text); padding:6px 12px; font-size:0.75rem; cursor:pointer; border-radius:4px; font-weight:600; z-index:10;}
        .locate-btn:hover {background:var(--hover); color:var(--accent);}

        /* CALCULATOR */
        .calc-wrap{max-width:900px;margin:0 auto}
        .calc-panel{background:var(--panel);border:1px solid var(--border);padding:20px;border-radius:4px}
        .input-group{margin-bottom:16px}
        .input-group label{display:block;font-size:.85rem;color:var(--dim);margin-bottom:6px;font-family:'JetBrains Mono',monospace}
        .input-group input,.input-group select{width:100%;padding:12px;background:var(--bg);border:1px solid var(--border);color:var(--text);font-family:'JetBrains Mono',monospace;font-size:1rem;border-radius:4px}
        .result-panel{background:var(--card);border:1px solid var(--accent-dim);padding:20px;border-radius:4px}
        .result-row{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--border)}
        .result-value{font-family:'JetBrains Mono',monospace;font-weight:700;color:var(--bright);font-size:1.1rem}

        /* RESOURCES */
        .resources-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px}
        .resource-card{background:var(--panel);border:1px solid var(--border);padding:20px;border-radius:4px}
        .resource-link{display:block;padding:12px 0;border-bottom:1px solid var(--border);color:var(--text);text-decoration:none;font-size:.95rem;transition:.2s}
        .resource-link:hover{color:var(--accent);padding-left:10px}

        /* FOOTER */
        footer {background:var(--panel); border-top:1px solid var(--border); padding:40px 0; margin-top:40px; font-size:0.9rem}
        .footer-inner {max-width:1800px; margin:0 auto; padding:0 20px; display:grid; grid-template-columns:1.5fr 1fr 1fr 1fr; gap:40px}
        .footer-col h4 {font-family:'JetBrains Mono',monospace; color:var(--accent); font-size:0.8rem; margin-bottom:16px; font-weight:700}
        .footer-col ul {list-style:none}
        .footer-col li {margin-bottom:10px}
        .footer-col a {color:var(--dim); text-decoration:none; transition:.2s}
        .footer-col a:hover {color:var(--bright)}
        .footer-bottom {max-width:1800px; margin:0 auto; padding:20px; border-top:1px solid var(--border); margin-top:40px; display:flex; justify-content:space-between; color:var(--dim); font-size:0.8rem}

        /* RESPONSIVE */
        @media(max-width:1000px){
            .grid-main{grid-template-columns:1fr}
            .sidebar-stack{position:static;max-height:none;overflow:visible}
            .footer-inner{grid-template-columns:1fr 1fr}
        }
        @media(max-width:600px){
            .weather-grid{grid-template-columns:1fr}
            .radar-box{border-right:none; border-bottom:1px solid var(--border)}
            .footer-inner{grid-template-columns:1fr}
            .grid-main{gap:10px}
        }
    </style>
</head>
<body>
    <div class="ticker-wrap">
        <div class="ticker" id="news-ticker">
            <span class="ticker-item">Initializing markets...</span>
        </div>
    </div>

    <header>
        <div class="header-inner">
            <a href="/" class="logo">
                <div class="logo-icon">
                    <span class="top-text">AG</span>
                    <span class="bot-text">SIST</span>
                </div>
                <div class="logo-text">AGSIST</div>
            </a>
            <nav class="nav">
                <a href="#dashboard" class="active" data-tab="dashboard">DASHBOARD</a>
                <a href="#calculator" data-tab="calculator">CALCULATOR</a>
                <a href="#offices" data-tab="offices">OFFICES</a>
                <a href="#resources" data-tab="resources">RESOURCES</a>
            </nav>
            <div class="live-badge"><span class="live-dot"></span><span id="update-time">Connecting...</span></div>
        </div>
    </header>

    <main>
        <div id="dashboard" class="tab active">
            <div class="grid-main">
                <div>
                    <div class="panel">
                        <div class="panel-head">
                            <h2>CONDITIONS ‚Äî <span id="location-name">LOCATING...</span></h2>
                        </div>
                        <div class="panel-body" style="padding:0">
                            <div class="weather-grid">
                                <div class="radar-box">
                                    <iframe id="radar-iframe" src=""></iframe>
                                    <button class="locate-btn" onclick="initWeather(true)">üìç Locate Me</button>
                                </div>
                                <div class="forecast-list" id="forecast">
                                    <div class="loading">Loading local forecast...</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-head"><h2>LIVE MARKETS</h2></div>
                        <div class="panel-body">
                            <div class="section-label" style="margin-top:0">GRAINS</div>
                            <div class="market-grid" id="grains-grid"><div class="loading">Loading...</div></div>
                            
                            <div class="section-label">LIVESTOCK</div>
                            <div class="market-grid" id="livestock-grid"><div class="loading">Loading...</div></div>
                            
                            <div class="section-label">INDICES & METALS</div>
                            <div class="market-grid" id="metals-grid"><div class="loading">Loading...</div></div>
                            
                            <div class="section-label">CRYPTO</div>
                            <div class="market-grid" id="crypto-grid"><div class="loading">Loading...</div></div>
                        </div>
                    </div>

                    <div class="panel">
                        <div class="panel-head"><h2>LOCAL GRAIN BUYERS</h2></div>
                        <div class="panel-body">
                            <div class="local-markets" id="local-markets">
                                <div class="elevator-item"><span class="elevator-name">Countryside Coop</span><span class="elevator-dist">12 mi</span></div>
                                <div class="elevator-item"><span class="elevator-name">CHS Inc</span><span class="elevator-dist">15 mi</span></div>
                                <div class="elevator-item"><span class="elevator-name">Cargill</span><span class="elevator-dist">22 mi</span></div>
                                <div class="elevator-item"><span class="elevator-name">ADM</span><span class="elevator-dist">28 mi</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-stack">
                    <div class="panel" style="margin-bottom:0">
                        <div class="panel-head"><h2>QUICK TOOLS</h2></div>
                        <div class="tool-grid">
                            <div onclick="switchTab('calculator')" class="tool-btn"><span>üåæ</span><h5>Bin Calc</h5></div>
                            <div onclick="switchTab('offices')" class="tool-btn"><span>üèõÔ∏è</span><h5>USDA Finder</h5></div>
                            <a href="https://webapp.rma.usda.gov/apps/actuarialinformationbrowser/" target="_blank" class="tool-btn"><span>üìä</span><h5>RMA Rates</h5></a>
                            <a href="https://farmers1st.com" target="_blank" class="tool-btn"><span>üîç</span><h5>Agent Finder</h5></a>
                        </div>
                    </div>

                    <div class="panel" style="margin-bottom:0">
                        <div class="feed-header">
                            LIVE FEED <span style="color:var(--dim)">@USDA</span>
                        </div>
                        <div class="feed-scroll" style="height:400px; position:relative">
                            <a class="twitter-timeline" 
                               data-theme="dark" 
                               data-chrome="noheader nofooter transparent" 
                               href="https://twitter.com/USDA?ref_src=twsrc%5Etfw">
                               <div style="padding:20px; text-align:center; color:var(--dim); font-size:0.9rem">
                                   Loading Twitter Feed...<br><br>
                                   <a href="https://twitter.com/USDA" target="_blank" style="color:var(--accent)">Click here if feed is blocked</a>
                               </div>
                            </a>
                        </div>
                    </div>

                    <div class="panel" style="margin-bottom:0">
                        <div class="feed-header">NEWS WIRE <span style="color:var(--dim)">RSS</span></div>
                        <div class="feed-scroll" id="news-wire-list" style="height:350px">
                            <div style="padding:20px; text-align:center; color:var(--dim)">Loading wire...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="calculator" class="tab">
            <div class="calc-wrap">
                <div class="panel">
                    <div class="panel-head"><h2>GRAIN BIN CALCULATOR</h2></div>
                    <div class="panel-body">
                         <div class="calc-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:24px">
                            <div class="calc-panel">
                                <h3>DIMENSIONS</h3>
                                <div class="input-group"><label>Bin Shape</label><select id="binShape" onchange="calcBin()"><option value="round">Round</option><option value="rect">Rectangular</option></select></div>
                                <div class="input-group" id="round-dims"><label>Diameter (ft)</label><input type="number" id="diameter" value="30" step=".5" oninput="calcBin()"></div>
                                <div class="input-group" id="rect-dims" style="display:none">
                                    <label>Length (ft)</label><input type="number" id="length" value="40" step=".5" oninput="calcBin()">
                                    <label style="margin-top:10px">Width (ft)</label><input type="number" id="width" value="30" step=".5" oninput="calcBin()">
                                </div>
                                <div class="input-group"><label>Eave Height (ft)</label><input type="number" id="eaveH" value="20" step=".5" oninput="calcBin()"></div>
                                <div class="input-group"><label>Grain Type</label><select id="grain" onchange="calcBin()">
                                    <option value="56|15.5">Corn (56 lb/bu)</option>
                                    <option value="60|13.0">Soybeans (60 lb/bu)</option>
                                    <option value="60|13.5">Wheat (60 lb/bu)</option>
                                    <option value="48|14.5">Barley (48 lb/bu)</option>
                                </select></div>
                                <div class="input-group" style="display:grid; grid-template-columns:1fr 1fr; gap:10px">
                                    <div><label>Current Moist %</label><input type="number" id="moistIn" value="15.5" step=".1" oninput="calcBin()"></div>
                                    <div><label>Pack Factor %</label><input type="number" id="pack" value="0" step=".5" oninput="calcBin()"></div>
                                </div>
                            </div>
                            <div>
                                <div class="result-panel">
                                    <h3>ESTIMATED CAPACITY</h3>
                                    <div class="result-row"><span>Total Volume</span><span class="result-value" id="rVol">-</span></div>
                                    <div class="result-row"><span>Total Bushels</span><span class="result-value big" id="rTotal" style="font-size:1.8rem; color:var(--accent)">-</span></div>
                                    <div class="result-row"><span>Total Weight</span><span class="result-value" id="rWeight">-</span></div>
                                    <div class="result-row" style="margin-top:10px; padding-top:10px; border-top:1px solid var(--border)"><span>Moisture Shrink</span><span class="result-value" id="rShrink">-</span></div>
                                    <div class="result-row"><span>Dry Bushels</span><span class="result-value" id="rDryBu">-</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="offices" class="tab">
            <div class="calc-wrap">
                <div class="panel">
                    <div class="panel-head"><h2>FIND USDA SERVICE CENTER</h2></div>
                    <div class="panel-body">
                        <div class="input-group">
                            <label>State</label>
                            <select id="state" onchange="loadCounties()">
                                <option value="">Select State</option>
                                <option value="WI">Wisconsin</option><option value="MN">Minnesota</option><option value="IA">Iowa</option>
                                <option value="IL">Illinois</option><option value="IN">Indiana</option><option value="MI">Michigan</option>
                                <option value="ND">North Dakota</option><option value="SD">South Dakota</option><option value="NE">Nebraska</option><option value="KS">Kansas</option><option value="MO">Missouri</option><option value="OH">Ohio</option>
                            </select>
                        </div>
                        <div class="input-group"><label>County</label><select id="county"><option>Select State First</option></select></div>
                        <button onclick="findOffice()" class="tool-btn" style="width:100%; margin-top:10px; font-weight:700; background:var(--accent); color:#000">LOCATE OFFICE</button>
                        <div id="office-results" style="margin-top:20px; display:none; grid-template-columns:1fr 1fr; gap:20px">
                            <div class="market-card">
                                <div class="name">FSA OFFICE</div>
                                <p style="font-size:.9rem; margin-top:10px">Farm Service Agency</p>
                                <a href="https://offices.sc.egov.usda.gov/locator/app" target="_blank" style="display:block; margin-top:10px; color:var(--accent)">View Contact Info &rarr;</a>
                            </div>
                            <div class="market-card">
                                <div class="name">NRCS OFFICE</div>
                                <p style="font-size:.9rem; margin-top:10px">Natural Resources Conservation</p>
                                <a href="https://offices.sc.egov.usda.gov/locator/app" target="_blank" style="display:block; margin-top:10px; color:var(--accent)">View Contact Info &rarr;</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="resources" class="tab">
            <div class="calc-wrap">
                <div class="panel">
                    <div class="panel-head"><h2>AG RESOURCES</h2></div>
                    <div class="panel-body">
                        <div class="resources-grid">
                            <div class="resource-card">
                                <h4 class="section-label">CROP INSURANCE (RMA)</h4>
                                <a href="https://webapp.rma.usda.gov/apps/actuarialinformationbrowser/" target="_blank" class="resource-link">Actuarial Information Browser</a>
                                <a href="https://www.rma.usda.gov/Topics/Important-Dates" target="_blank" class="resource-link">Important Dates & Deadlines</a>
                                <a href="https://www.rma.usda.gov/Topics/Price-Discovery" target="_blank" class="resource-link">Price Discovery</a>
                                <a href="https://www.rma.usda.gov/Policy-and-Procedure/Insurance-Plans" target="_blank" class="resource-link">Insurance Plans (RP, YP, etc)</a>
                            </div>
                            <div class="resource-card">
                                <h4 class="section-label">FARM SERVICE AGENCY (FSA)</h4>
                                <a href="https://www.fsa.usda.gov/programs-and-services/farm-loan-programs/" target="_blank" class="resource-link">Farm Loan Programs</a>
                                <a href="https://www.fsa.usda.gov/programs-and-services/arcplc_program/" target="_blank" class="resource-link">ARC / PLC Program</a>
                                <a href="https://www.fsa.usda.gov/programs-and-services/conservation-programs/" target="_blank" class="resource-link">Conservation Reserve (CRP)</a>
                                <a href="https://www.fsa.usda.gov/programs-and-services/disaster-assistance-program/" target="_blank" class="resource-link">Disaster Assistance</a>
                            </div>
                            <div class="resource-card">
                                <h4 class="section-label">NRCS & SOIL</h4>
                                <a href="https://websoilsurvey.nrcs.usda.gov/app/" target="_blank" class="resource-link">Web Soil Survey</a>
                                <a href="https://www.nrcs.usda.gov/programs-initiatives/eqip-environmental-quality-incentives" target="_blank" class="resource-link">EQIP Program</a>
                                <a href="https://www.nrcs.usda.gov/programs-initiatives/csp-conservation-stewardship-program" target="_blank" class="resource-link">CSP Program</a>
                            </div>
                            <div class="resource-card">
                                <h4 class="section-label">MARKET & WEATHER</h4>
                                <a href="https://www.usda.gov/oce/commodity/wasde" target="_blank" class="resource-link">WASDE Reports</a>
                                <a href="https://www.ams.usda.gov/market-news" target="_blank" class="resource-link">USDA Market News</a>
                                <a href="https://droughtmonitor.unl.edu/" target="_blank" class="resource-link">US Drought Monitor</a>
                                <a href="https://www.cpc.ncep.noaa.gov/" target="_blank" class="resource-link">NOAA Climate Prediction</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-inner">
            <div class="footer-col">
                <div class="logo" style="margin-bottom:16px">
                    <div class="logo-icon" style="width:32px; height:32px">
                        <span class="top-text">AG</span><span class="bot-text">SIST</span>
                    </div>
                    <span class="logo-text" style="font-size:1.2rem">AGSIST</span>
                </div>
                <p style="color:var(--dim); line-height:1.6; margin-bottom:16px">
                    Professional grade market intelligence, weather data, and USDA tools built for the modern American farmer.
                </p>
                <div style="display:flex; gap:10px; align-items:center">
                    <span style="width:8px; height:8px; background:var(--green); border-radius:50%"></span>
                    <span style="color:var(--text); font-size:0.8rem">All Systems Operational</span>
                </div>
            </div>
            <div class="footer-col">
                <h4>PLATFORM</h4>
                <ul>
                    <li><a href="#dashboard" onclick="switchTab('dashboard')">Live Dashboard</a></li>
                    <li><a href="#calculator" onclick="switchTab('calculator')">Grain Calculator</a></li>
                    <li><a href="#offices" onclick="switchTab('offices')">USDA Locator</a></li>
                    <li><a href="#resources" onclick="switchTab('resources')">Resources</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>COMPANY</h4>
                <ul>
                    <li><a href="https://farmers1st.com" target="_blank">About Us</a></li>
                    <li><a href="https://farmers1st.com" target="_blank">Contact</a></li>
                    <li><a href="#">Advertising</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>LEGAL</h4>
                <ul>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Terms of Service</a></li>
                    <li><a href="/sitemap.xml">Sitemap</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <span>&copy; 2026 AGSIST. All rights reserved.</span>
            <span>Made in the USA üá∫üá∏</span>
        </div>
    </footer>

    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // SAFE INIT
            try {
                loadData();
                initWeather();
                calcBin();
                setInterval(loadData, 60000);
            } catch(e) {
                console.error("Init failed:", e);
                document.getElementById('update-time').innerText = "System Error";
            }
        });

        // --- NAVIGATION ---
        function switchTab(id) {
            window.scrollTo({top:0, behavior:'smooth'});
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav a').forEach(a => a.classList.remove('active'));
            document.getElementById(id)?.classList.add('active');
            document.querySelector(`.nav a[data-tab="${id}"]`)?.classList.add('active');
        }

        document.querySelectorAll('[data-tab]').forEach(el => {
            el.addEventListener('click', e => {
                e.preventDefault();
                switchTab(el.dataset.tab);
            });
        });

        // --- DATA LOADER ---
        async function loadData() {
            try {
                const res = await fetch('data/markets.json');
                if(!res.ok) throw new Error("JSON not found");
                const data = await res.json();
                const m = data.markets;
                
                document.getElementById('update-time').textContent = new Date(data.updated).toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});

                renderGrid('grains-grid', [m.grains?.corn, m.grains?.soybeans, m.grains?.wheat]);
                renderGrid('livestock-grid', [m.livestock?.cattle, m.livestock?.feeder, m.livestock?.milk]);
                renderGrid('metals-grid', [m.indices?.sp500, m.indices?.dow, m.metals?.gold, m.metals?.silver]);
                renderGrid('crypto-grid', [m.crypto?.bitcoin, m.crypto?.ethereum, m.crypto?.kaspa, m.crypto?.xrp]);

                renderNews(data.news || []);
                updateTicker(m, data.news || []);
            } catch (e) { 
                console.error(e); 
                document.getElementById('update-time').textContent = "Connection Failed";
            }
        }

        function renderGrid(id, items) {
            const el = document.getElementById(id);
            if(!el) return;
            el.innerHTML = items.filter(Boolean).map(item => {
                const isUp = item.change >= 0;
                const sign = isUp ? '+' : '';
                const color = isUp ? 'var(--green)' : 'var(--red)';
                
                // Range Calculation
                let rangeHtml = '';
                if(item.low52 && item.high52) {
                    const pct = ((item.price - item.low52)/(item.high52 - item.low52)) * 100;
                    rangeHtml =
