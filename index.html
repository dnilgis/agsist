<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6KXCTD5Z9H"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-6KXCTD5Z9H');</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGSIST | Free Live Ag Dashboard - Corn, Soybean, Wheat Prices</title>
    <meta name="description" content="Free live agricultural commodity prices, weather radar, and farm tools. Corn, soybean, wheat futures updated every 15 minutes. Built by Wisconsin farmers.">
    <meta name="keywords" content="corn prices today, soybean prices, wheat futures, ag commodity prices, farm dashboard, grain prices, livestock prices">
    <link rel="canonical" href="https://agsist.com/">
    
    <!-- Schema.org for Organization -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "AGSIST",
        "description": "Free agricultural dashboard with live commodity prices, farm calculators, and tools for farmers",
        "url": "https://agsist.com",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://agsist.com/tools.html",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "AGSIST",
        "url": "https://agsist.com",
        "logo": "https://agsist.com/icon-512.png",
        "description": "Agricultural technology tools built by farmers for farmers in Wisconsin",
        "address": {
            "@type": "PostalAddress",
            "addressRegion": "WI",
            "addressCountry": "US"
        },
        "sameAs": [
            "https://farmers1st.com",
            "https://lokedrone.com"
        ]
    }
    </script>
    
    <!-- PWA -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#e6b042">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="AGSIST">
    
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    <meta property="og:title" content="AGSIST | Free Live Ag Dashboard">
    <meta property="og:description" content="Free live commodity prices, weather radar, and farm tools. Built by Wisconsin farmers.">
    <meta property="og:image" content="https://agsist.com/og-image.png">
    <meta property="og:url" content="https://agsist.com/">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg: #0a0a0a;
            --card: #111;
            --border: #222;
            --text: #e8e8e8;
            --dim: #666;
            --accent: #e6b042;
            --green: #22c55e;
            --red: #ef4444;
        }
        
        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg);
            color: var(--text);
            line-height: 1.5;
            min-height: 100vh;
        }
        
        /* NAV - sticky but slim */
        nav {
            background: var(--card);
            border-bottom: 1px solid var(--border);
            padding: 12px 16px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        /* TICKER */
        .ticker-wrap {
            background: var(--card);
            border-bottom: 1px solid var(--border);
            overflow: hidden;
            padding: 8px 0;
        }
        
        .ticker {
            display: flex;
            gap: 40px;
            animation: ticker-scroll 60s linear infinite;
            white-space: nowrap;
            width: max-content;
        }
        
        .ticker:hover {
            animation-play-state: paused;
        }
        
        .ticker-item {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
        }
        
        .ticker-item .label {
            color: var(--dim);
        }
        
        .ticker-item .price {
            color: var(--text);
            font-weight: 600;
        }
        
        .ticker-item .change {
            font-size: 0.75rem;
        }
        
        .ticker-item .change.up { color: var(--green); }
        .ticker-item .change.down { color: var(--red); }
        
        .ticker-item.news {
            color: var(--accent);
            max-width: 400px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        @keyframes ticker-scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        .nav-inner {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--accent);
            text-decoration: none;
        }
        
        .nav-links {
            display: flex;
            gap: 8px;
        }
        
        .nav-links a {
            color: var(--dim);
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        
        .nav-links a:hover, .nav-links a.active {
            color: var(--text);
            background: var(--border);
        }
        
        /* MAIN CONTENT */
        main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 16px;
        }
        
        /* UPDATE TIME */
        .update-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            font-size: 0.75rem;
            color: var(--dim);
        }
        
        /* PRICE CARDS */
        .price-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .price-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
        }
        
        .price-card.featured {
            border-color: var(--accent);
        }
        
        .price-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .price-label {
            font-size: 0.8rem;
            color: var(--dim);
            text-transform: uppercase;
        }
        
        .price-contract {
            font-size: 0.7rem;
            color: var(--dim);
            background: var(--border);
            padding: 2px 6px;
            border-radius: 3px;
        }
        
        .price-value {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .price-change {
            font-size: 0.85rem;
        }
        
        .price-change.up { color: var(--green); }
        .price-change.down { color: var(--red); }
        
        /* SECTION HEADERS */
        .section-header {
            font-size: 0.75rem;
            color: var(--dim);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin: 20px 0 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }
        
        /* SECONDARY PRICES - smaller grid */
        .secondary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .secondary-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 12px;
        }
        
        .secondary-label {
            font-size: 0.7rem;
            color: var(--dim);
            margin-bottom: 4px;
        }
        
        .secondary-value {
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .secondary-change {
            font-size: 0.75rem;
        }
        
        /* WEATHER */
        .weather-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 16px;
        }
        
        .weather-card iframe {
            width: 100%;
            height: 300px;
            border: none;
        }
        
        /* NEWS */
        .news-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
        }
        
        .news-item {
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }
        
        .news-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .news-item:first-child {
            padding-top: 0;
        }
        
        .news-item a {
            color: var(--text);
            text-decoration: none;
            font-size: 0.9rem;
            line-height: 1.4;
            display: block;
        }
        
        .news-item a:hover {
            color: var(--accent);
        }
        
        .news-source {
            font-size: 0.7rem;
            color: var(--dim);
            margin-top: 4px;
        }
        
        /* FOOTER */
        footer {
            border-top: 1px solid var(--border);
            padding: 20px 16px;
            margin-top: 30px;
            text-align: center;
            font-size: 0.75rem;
            color: var(--dim);
        }
        
        footer a {
            color: var(--accent);
            text-decoration: none;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }
        
        /* DESKTOP */
        @media (min-width: 768px) {
            main { padding: 24px; }
            
            .price-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .secondary-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .two-col {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 16px;
            }
            
            .weather-card iframe {
                height: 400px;
            }
        }
        
        @media (min-width: 1024px) {
            .secondary-grid {
                grid-template-columns: repeat(6, 1fr);
            }
        }
        
        /* LOADING STATE */
        .loading {
            color: var(--dim);
            font-style: italic;
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-inner">
            <a href="/" class="logo">AGSIST</a>
            <div class="nav-links">
                <a href="/tools.html">Tools</a>
                <a href="/fastfacts.html">Fast Facts</a>
                <a href="/learn.html">Learn</a>
                <a href="/calendar.html">Calendar</a>
                <a href="/resources.html">Resources</a>
            </div>
        </div>
    </nav>
    
    <!-- TICKER -->
    <div class="ticker-wrap">
        <div class="ticker" id="ticker">
            <!-- Populated by JS -->
        </div>
    </div>
    
    <main>
        <div id="welcome-msg" style="margin-bottom:12px;font-size:0.95rem;color:var(--text)"></div>
        <div class="update-bar">
            <span>Last updated: <span id="update-time" class="loading">Loading...</span></span>
            <span>Data auto-refreshes</span>
        </div>
        
        <!-- PRIMARY: Corn & Soybeans -->
        <div class="price-grid" id="primary-prices">
            <div class="price-card featured">
                <div class="price-header">
                    <span class="price-label">üåΩ Corn</span>
                    <span class="price-contract" id="corn-contract">--</span>
                </div>
                <div class="price-value" id="corn-price">--</div>
                <div class="price-change" id="corn-change">--</div>
            </div>
            <div class="price-card">
                <div class="price-header">
                    <span class="price-label">üåΩ Corn Harvest</span>
                    <span class="price-contract">Dec '26</span>
                </div>
                <div class="price-value" id="corn-dec-price">--</div>
                <div class="price-change" id="corn-dec-change">--</div>
            </div>
            <div class="price-card featured">
                <div class="price-header">
                    <span class="price-label">ü´ò Soybeans</span>
                    <span class="price-contract" id="soy-contract">--</span>
                </div>
                <div class="price-value" id="soy-price">--</div>
                <div class="price-change" id="soy-change">--</div>
            </div>
            <div class="price-card">
                <div class="price-header">
                    <span class="price-label">ü´ò Beans Harvest</span>
                    <span class="price-contract">Nov '26</span>
                </div>
                <div class="price-value" id="soy-nov-price">--</div>
                <div class="price-change" id="soy-nov-change">--</div>
            </div>
        </div>
        
        <!-- SECONDARY: Other commodities -->
        <div class="section-header">Livestock & More</div>
        <div class="secondary-grid" id="secondary-prices">
            <div class="secondary-card">
                <div class="secondary-label">Wheat</div>
                <div class="secondary-value" id="wheat-price">--</div>
                <div class="secondary-change" id="wheat-change">--</div>
            </div>
            <div class="secondary-card">
                <div class="secondary-label">Live Cattle</div>
                <div class="secondary-value" id="cattle-price">--</div>
                <div class="secondary-change" id="cattle-change">--</div>
            </div>
            <div class="secondary-card">
                <div class="secondary-label">Feeder Cattle</div>
                <div class="secondary-value" id="feeder-price">--</div>
                <div class="secondary-change" id="feeder-change">--</div>
            </div>
            <div class="secondary-card">
                <div class="secondary-label">Lean Hogs</div>
                <div class="secondary-value" id="hogs-price">--</div>
                <div class="secondary-change" id="hogs-change">--</div>
            </div>
            <div class="secondary-card">
                <div class="secondary-label">Class III Milk</div>
                <div class="secondary-value" id="milk-price">--</div>
                <div class="secondary-change" id="milk-change">--</div>
            </div>
            <div class="secondary-card">
                <div class="secondary-label">Crude Oil</div>
                <div class="secondary-value" id="oil-price">--</div>
                <div class="secondary-change" id="oil-change">--</div>
            </div>
        </div>
        
        <!-- LOCAL CASH BIDS -->
        <div class="section-header" style="margin-top:24px;display:flex;justify-content:space-between;align-items:center">
            <span>Local Cash Bids (NW Wisconsin)</span>
            <a href="https://www.dtn.com/agriculture/cash-bids/" target="_blank" style="font-size:0.7rem;color:var(--accent);text-decoration:none">More bids ‚Üí</a>
        </div>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:10px;margin-bottom:16px">
            <!-- Row 1 -->
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">FlashGrain</span>
                    <a href="https://flashgrain.com" target="_blank" style="font-size:0.6rem;color:var(--accent);text-decoration:none">Site ‚Üí</a>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Real-time digital bids</div>
            </div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">CDR Farms</span>
                    <span style="font-size:0.6rem;color:var(--dim)">715-455-1474</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Prairie Farm area</div>
            </div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">Rooney Farms</span>
                    <span style="font-size:0.6rem;color:var(--dim)">715-749-3800</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Glenwood City</div>
            </div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">Chippewa Valley Grain</span>
                    <span style="font-size:0.6rem;color:var(--dim)">715-723-8555</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Chippewa Falls</div>
            </div>
            <!-- Row 2 -->
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">Emmert's</span>
                    <span style="font-size:0.6rem;color:var(--dim)">715-597-3145</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Augusta</div>
            </div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">Jennie-O Turkey Store</span>
                    <span style="font-size:0.6rem;color:var(--dim)">715-568-4000</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Barron (corn)</div>
            </div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">Equity Cooperative</span>
                    <span style="font-size:0.6rem;color:var(--dim)">715-537-3144</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Barron</div>
            </div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">CHS - Rice Lake</span>
                    <span style="font-size:0.6rem;color:var(--dim)">715-234-8877</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Rice Lake</div>
            </div>
            <!-- Row 3 -->
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">Landmark - Cameron</span>
                    <span style="font-size:0.6rem;color:var(--dim)">715-458-2171</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Cameron</div>
            </div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">United Farmers Coop</span>
                    <span style="font-size:0.6rem;color:var(--dim)">715-268-7137</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Amery</div>
            </div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">Compeer Financial</span>
                    <span style="font-size:0.6rem;color:var(--dim)">844-426-6733</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Regional financing</div>
            </div>
            <div style="background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
                    <span style="font-size:0.8rem;font-weight:600">River Country Coop</span>
                    <span style="font-size:0.6rem;color:var(--dim)">715-235-4533</span>
                </div>
                <div style="font-size:0.75rem;color:var(--dim)">Menomonie</div>
            </div>
        </div>
        <div style="font-size:0.7rem;color:var(--dim);text-align:center;margin-bottom:24px">
            üí° Cash bids change daily. Call elevators for current prices. <a href="/learn.html#basis" style="color:var(--accent);text-decoration:none">Learn about basis ‚Üí</a>
        </div>
        
        <!-- WEATHER & NEWS side by side on desktop -->
        <div class="two-col">
            <div>
                <div class="section-header" style="display:flex;justify-content:space-between;align-items:center">
                    <span>Weather Radar</span>
                    <select id="radar-select" onchange="changeRadar()" style="background:var(--bg);border:1px solid var(--border);color:var(--text);padding:4px 8px;border-radius:4px;font-size:0.7rem;font-family:inherit">
                        <option value="KARX">La Crosse, WI</option>
                        <option value="KMKX">Milwaukee, WI</option>
                        <option value="KGRB">Green Bay, WI</option>
                        <option value="KDLH">Duluth, MN</option>
                        <option value="KMPX">Minneapolis, MN</option>
                        <option value="KFSD">Sioux Falls, SD</option>
                        <option value="KDMX">Des Moines, IA</option>
                        <option value="KDVN">Davenport, IA</option>
                        <option value="KLOT">Chicago, IL</option>
                        <option value="KFGF">Fargo, ND</option>
                    </select>
                </div>
                <div class="weather-card">
                    <iframe id="radar-frame" src="https://radar.weather.gov/ridge/standard/KARX_loop.gif" title="NWS Radar"></iframe>
                </div>
                <div style="font-size:0.7rem;color:var(--dim);margin-top:8px;text-align:center" id="radar-status">
                    üìç Detecting your location...
                </div>
            </div>
            <div>
                <div class="section-header">Ag News</div>
                <div class="news-card" id="news-feed">
                    <div class="news-item loading">Loading news...</div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- ABOUT SECTION -->
    <section style="max-width:800px;margin:40px auto;padding:0 16px">
        <div style="background:var(--card);border:1px solid var(--border);border-radius:8px;padding:24px;text-align:center">
            <h2 style="font-size:1.1rem;margin-bottom:16px;color:var(--accent)">Built by Farmers, for Farmers</h2>
            <p style="color:var(--dim);font-size:0.9rem;line-height:1.7;margin-bottom:16px">
                AGSIST was created in rural Wisconsin by people who actually farm. We got tired of slow, cluttered ag sites filled with ads. So we built something better ‚Äî fast, clean, and focused on what matters: prices, weather, and tools that work.
            </p>
            <p style="color:var(--dim);font-size:0.9rem;line-height:1.7;margin-bottom:20px">
                We run <a href="https://farmers1st.com" target="_blank" style="color:var(--accent)">Farmers First Agri Service</a> (crop insurance & agronomy) and <a href="https://lokedrone.com" target="_blank" style="color:var(--accent)">Loke Drone LC</a> (agricultural drone services) right here in Barron County. This isn't a side project from some tech company ‚Äî it's built by your neighbors.
            </p>
            <div style="display:flex;justify-content:center;gap:12px;flex-wrap:wrap">
                <span style="background:var(--bg);padding:6px 12px;border-radius:4px;font-size:0.75rem;color:var(--dim)">üìç Barron County, WI</span>
                <span style="background:var(--bg);padding:6px 12px;border-radius:4px;font-size:0.75rem;color:var(--dim)">üåΩ Family Farm</span>
                <span style="background:var(--bg);padding:6px 12px;border-radius:4px;font-size:0.75rem;color:var(--dim)">üöú Since 2020</span>
            </div>
        </div>
    </section>
    
    <footer>
        <div class="footer-links">
            <a href="https://farmers1st.com" target="_blank">üåæ Farmers First Agri</a>
            <a href="https://lokedrone.com" target="_blank">‚úàÔ∏è Loke Drone</a>
            <a href="https://usdronemap.com" target="_blank">üó∫Ô∏è US Drone Map</a>
        </div>
        <div>¬© 2026 AGSIST ‚Ä¢ Made in the USA üá∫üá∏</div>
    </footer>
    
    <script>
    async function loadData() {
        try {
            const res = await fetch('data/markets.json');
            if (!res.ok) throw new Error('Failed to load');
            const data = await res.json();
            
            // Update time
            document.getElementById('update-time').textContent = 
                new Date(data.updated).toLocaleString([], {month:'short', day:'numeric', hour:'2-digit', minute:'2-digit'});
            document.getElementById('update-time').classList.remove('loading');
            
            const m = data.markets;
            
            // Helper to format price
            const fmt = (val, unit) => {
                if (unit === '¬¢/bu') return (val / 100).toFixed(2);
                if (unit === '¬¢/lb') return val.toFixed(2);
                if (unit === '$/cwt') return val.toFixed(2);
                if (unit === '$/bbl') return val.toFixed(2);
                return val.toFixed(2);
            };
            
            // Helper to set change class
            const chgClass = (val) => val >= 0 ? 'up' : 'down';
            const chgSign = (val) => val >= 0 ? '+' : '';
            
            // CORN
            if (m.grains?.corn) {
                const c = m.grains.corn;
                document.getElementById('corn-contract').textContent = c.contract || 'Front';
                document.getElementById('corn-price').textContent = '$' + fmt(c.price, c.unit);
                document.getElementById('corn-change').textContent = chgSign(c.change) + (c.change/100).toFixed(2) + ' (' + chgSign(c.changePct) + c.changePct.toFixed(1) + '%)';
                document.getElementById('corn-change').className = 'price-change ' + chgClass(c.change);
            }
            
            // CORN DEC
            if (m.grains?.corn_dec) {
                const c = m.grains.corn_dec;
                document.getElementById('corn-dec-price').textContent = '$' + fmt(c.price, c.unit);
                document.getElementById('corn-dec-change').textContent = chgSign(c.change) + (c.change/100).toFixed(2) + ' (' + chgSign(c.changePct) + c.changePct.toFixed(1) + '%)';
                document.getElementById('corn-dec-change').className = 'price-change ' + chgClass(c.change);
            }
            
            // SOYBEANS
            if (m.grains?.soybeans) {
                const c = m.grains.soybeans;
                document.getElementById('soy-contract').textContent = c.contract || 'Front';
                document.getElementById('soy-price').textContent = '$' + fmt(c.price, c.unit);
                document.getElementById('soy-change').textContent = chgSign(c.change) + (c.change/100).toFixed(2) + ' (' + chgSign(c.changePct) + c.changePct.toFixed(1) + '%)';
                document.getElementById('soy-change').className = 'price-change ' + chgClass(c.change);
            }
            
            // SOYBEANS NOV
            if (m.grains?.soybeans_nov) {
                const c = m.grains.soybeans_nov;
                document.getElementById('soy-nov-price').textContent = '$' + fmt(c.price, c.unit);
                document.getElementById('soy-nov-change').textContent = chgSign(c.change) + (c.change/100).toFixed(2) + ' (' + chgSign(c.changePct) + c.changePct.toFixed(1) + '%)';
                document.getElementById('soy-nov-change').className = 'price-change ' + chgClass(c.change);
            }
            
            // WHEAT
            if (m.grains?.wheat) {
                const c = m.grains.wheat;
                document.getElementById('wheat-price').textContent = '$' + fmt(c.price, c.unit);
                document.getElementById('wheat-change').textContent = chgSign(c.changePct) + c.changePct.toFixed(1) + '%';
                document.getElementById('wheat-change').className = 'secondary-change ' + chgClass(c.change);
            }
            
            // CATTLE
            if (m.livestock?.cattle) {
                const c = m.livestock.cattle;
                document.getElementById('cattle-price').textContent = '$' + c.price.toFixed(2);
                document.getElementById('cattle-change').textContent = chgSign(c.changePct) + c.changePct.toFixed(1) + '%';
                document.getElementById('cattle-change').className = 'secondary-change ' + chgClass(c.change);
            }
            
            // FEEDER
            if (m.livestock?.feeder) {
                const c = m.livestock.feeder;
                document.getElementById('feeder-price').textContent = '$' + c.price.toFixed(2);
                document.getElementById('feeder-change').textContent = chgSign(c.changePct) + c.changePct.toFixed(1) + '%';
                document.getElementById('feeder-change').className = 'secondary-change ' + chgClass(c.change);
            }
            
            // HOGS
            if (m.livestock?.hogs) {
                const c = m.livestock.hogs;
                document.getElementById('hogs-price').textContent = '$' + c.price.toFixed(2);
                document.getElementById('hogs-change').textContent = chgSign(c.changePct) + c.changePct.toFixed(1) + '%';
                document.getElementById('hogs-change').className = 'secondary-change ' + chgClass(c.change);
            }
            
            // MILK
            if (m.livestock?.milk) {
                const c = m.livestock.milk;
                document.getElementById('milk-price').textContent = '$' + c.price.toFixed(2);
                document.getElementById('milk-change').textContent = chgSign(c.changePct) + c.changePct.toFixed(1) + '%';
                document.getElementById('milk-change').className = 'secondary-change ' + chgClass(c.change);
            }
            
            // OIL
            if (m.energy?.oil) {
                const c = m.energy.oil;
                document.getElementById('oil-price').textContent = '$' + c.price.toFixed(2);
                document.getElementById('oil-change').textContent = chgSign(c.changePct) + c.changePct.toFixed(1) + '%';
                document.getElementById('oil-change').className = 'secondary-change ' + chgClass(c.change);
            }
            
            // NEWS
            if (data.news && data.news.length > 0) {
                const newsEl = document.getElementById('news-feed');
                newsEl.innerHTML = data.news.slice(0, 8).map(n => `
                    <div class="news-item">
                        <a href="${n.link}" target="_blank">${n.title}</a>
                        <div class="news-source">${n.source || 'Ag News'}</div>
                    </div>
                `).join('');
            }
            
            // TICKER
            buildTicker(m, data.news || []);
            
        } catch (e) {
            console.error(e);
            document.getElementById('update-time').textContent = 'Offline';
            document.getElementById('update-time').classList.remove('loading');
        }
    }
    
    function buildTicker(m, news) {
        const items = [];
        const chgClass = (val) => val >= 0 ? 'up' : 'down';
        const chgSign = (val) => val >= 0 ? '+' : '';
        
        // Corn
        if (m.grains?.corn) {
            const c = m.grains.corn;
            items.push(`<span class="ticker-item"><span class="label">üåΩ Corn</span><span class="price">$${(c.price/100).toFixed(2)}</span><span class="change ${chgClass(c.change)}">${chgSign(c.changePct)}${c.changePct.toFixed(1)}%</span></span>`);
        }
        
        // Soybeans
        if (m.grains?.soybeans) {
            const c = m.grains.soybeans;
            items.push(`<span class="ticker-item"><span class="label">ü´ò Beans</span><span class="price">$${(c.price/100).toFixed(2)}</span><span class="change ${chgClass(c.change)}">${chgSign(c.changePct)}${c.changePct.toFixed(1)}%</span></span>`);
        }
        
        // Wheat
        if (m.grains?.wheat) {
            const c = m.grains.wheat;
            items.push(`<span class="ticker-item"><span class="label">üåæ Wheat</span><span class="price">$${(c.price/100).toFixed(2)}</span><span class="change ${chgClass(c.change)}">${chgSign(c.changePct)}${c.changePct.toFixed(1)}%</span></span>`);
        }
        
        // Cattle
        if (m.livestock?.cattle) {
            const c = m.livestock.cattle;
            items.push(`<span class="ticker-item"><span class="label">üêÑ Cattle</span><span class="price">$${c.price.toFixed(2)}</span><span class="change ${chgClass(c.change)}">${chgSign(c.changePct)}${c.changePct.toFixed(1)}%</span></span>`);
        }
        
        // Bitcoin
        if (m.crypto?.bitcoin) {
            const c = m.crypto.bitcoin;
            items.push(`<span class="ticker-item"><span class="label">‚Çø BTC</span><span class="price">$${c.price.toLocaleString(undefined,{maximumFractionDigits:0})}</span><span class="change ${chgClass(c.change)}">${chgSign(c.changePct)}${c.changePct.toFixed(1)}%</span></span>`);
        }
        
        // Kaspa - 3 decimal places
        if (m.crypto?.kaspa) {
            const c = m.crypto.kaspa;
            items.push(`<span class="ticker-item"><span class="label">KAS</span><span class="price">$${c.price.toFixed(3)}</span><span class="change ${chgClass(c.change)}">${chgSign(c.changePct)}${c.changePct.toFixed(1)}%</span></span>`);
        }
        
        // Add news headlines
        if (news.length > 0) {
            news.slice(0, 3).forEach(n => {
                items.push(`<span class="ticker-item news">üì∞ ${n.title}</span>`);
            });
        }
        
        // Duplicate for seamless scroll
        const tickerEl = document.getElementById('ticker');
        tickerEl.innerHTML = items.join('') + items.join('');
    }
    
    loadData();
    // Refresh every 5 minutes
    setInterval(loadData, 5 * 60 * 1000);
    
    // RADAR STATIONS with lat/lon
    const RADAR_STATIONS = [
        { code: 'KARX', name: 'La Crosse, WI', lat: 43.82, lon: -91.19 },
        { code: 'KMKX', name: 'Milwaukee, WI', lat: 42.97, lon: -88.55 },
        { code: 'KGRB', name: 'Green Bay, WI', lat: 44.50, lon: -88.11 },
        { code: 'KDLH', name: 'Duluth, MN', lat: 46.84, lon: -92.21 },
        { code: 'KMPX', name: 'Minneapolis, MN', lat: 44.85, lon: -93.57 },
        { code: 'KFSD', name: 'Sioux Falls, SD', lat: 43.59, lon: -96.73 },
        { code: 'KDMX', name: 'Des Moines, IA', lat: 41.73, lon: -93.72 },
        { code: 'KDVN', name: 'Davenport, IA', lat: 41.61, lon: -90.58 },
        { code: 'KLOT', name: 'Chicago, IL', lat: 41.60, lon: -88.08 },
        { code: 'KFGF', name: 'Fargo, ND', lat: 47.45, lon: -96.86 }
    ];
    
    function changeRadar() {
        const code = document.getElementById('radar-select').value;
        const station = RADAR_STATIONS.find(s => s.code === code);
        document.getElementById('radar-frame').src = `https://radar.weather.gov/ridge/standard/${code}_loop.gif`;
        document.getElementById('radar-status').textContent = `üìç ${station.name}`;
    }
    
    function findNearestRadar(lat, lon) {
        let nearest = RADAR_STATIONS[0];
        let minDist = Infinity;
        
        RADAR_STATIONS.forEach(station => {
            const dist = Math.sqrt(Math.pow(lat - station.lat, 2) + Math.pow(lon - station.lon, 2));
            if (dist < minDist) {
                minDist = dist;
                nearest = station;
            }
        });
        
        return nearest;
    }
    
    // Welcome message based on time
    function getGreeting() {
        const hour = new Date().getHours();
        if (hour < 5) return 'üåô Late night';
        if (hour < 12) return '‚òÄÔ∏è Good morning';
        if (hour < 17) return 'üå§Ô∏è Good afternoon';
        if (hour < 21) return 'üåÖ Good evening';
        return 'üåô Good night';
    }
    
    function setWelcome(location) {
        const greeting = getGreeting();
        const msg = location ? `${greeting} from ${location}` : greeting;
        document.getElementById('welcome-msg').textContent = msg;
    }
    
    // Set default welcome
    setWelcome('');
    
    // Geolocation
    if ('geolocation' in navigator) {
        navigator.geolocation.getCurrentPosition(
            (pos) => {
                const nearest = findNearestRadar(pos.coords.latitude, pos.coords.longitude);
                document.getElementById('radar-select').value = nearest.code;
                document.getElementById('radar-frame').src = `https://radar.weather.gov/ridge/standard/${nearest.code}_loop.gif`;
                document.getElementById('radar-status').textContent = `üìç ${nearest.name} (nearest to you)`;
                
                // Reverse geocode to get county/city name
                fetch(`https://nominatim.openstreetmap.org/reverse?lat=${pos.coords.latitude}&lon=${pos.coords.longitude}&format=json`)
                    .then(r => r.json())
                    .then(data => {
                        const county = data.address?.county || data.address?.city || data.address?.state || '';
                        if (county) setWelcome(county);
                    })
                    .catch(() => setWelcome(nearest.name.split(',')[0]));
            },
            (err) => {
                // Default to La Crosse (Barron County area)
                document.getElementById('radar-status').textContent = 'üìç La Crosse, WI (default)';
                setWelcome('');
            },
            { timeout: 5000, maximumAge: 600000 }
        );
    } else {
        document.getElementById('radar-status').textContent = 'üìç La Crosse, WI (default)';
        setWelcome('');
    }
    
    // Register Service Worker for PWA
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js').then(() => {
            console.log('AGSIST: Service Worker registered');
        }).catch((err) => {
            console.log('SW registration failed:', err);
        });
    }
    </script>
</body>
</html>
